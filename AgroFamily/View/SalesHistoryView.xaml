<UserControl x:Class="AgroFamily.View.SalesHistoryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:AgroFamily.View" xmlns:viewmodel="clr-namespace:AgroFamily.ViewModel"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.DataContext>
        <viewmodel:SaleHistoryViewModel/>
    </UserControl.DataContext>
    <!--Main Window Grid-->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!--Searching Section Grid-->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="50"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!--Section Title-->
            <TextBlock Text="Buscar Ventas"
                       Grid.Row="0"
                       TextAlignment="Center"
                       FontSize="24"
                       Margin="118,0,118,1"
                       />
            <!--Searching Parameters Section-->
            <Grid Grid.Row="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="40"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Busqueda por:"
                               TextAlignment="Left"
                               HorizontalAlignment="Left"
                               VerticalAlignment="Center" 
                               Margin="10,0,0,0"/>
                    <!--Search by id-->
                    <RadioButton x:Name="IDSButton" 
                                 Margin="116,0,0,0"
                                 HorizontalAlignment="Left"
                                 VerticalAlignment="Center" 
                                 Width="99"
                                 Content="Identificadores"
                                 Checked="IDSButton_Checked"
                                 IsChecked="{Binding SearchByID}"
                                 />
                    <!--Search by dates-->
                    <RadioButton x:Name="DatesButton"
                                 Margin="244,0,0,0"
                                 HorizontalAlignment="Left"
                                 VerticalAlignment="Center" 
                                 Width="99"
                                 Content="Fechas" 
                                 Checked="DatesButton_Checked"
                                 IsChecked="{Binding SearchByDates}"
                                 />

                    <CheckBox x:Name="SellerIDSelector"
                              Grid.Row="1"
                              Width="108"
                              Height="18"
                              VerticalAlignment="Top"
                              HorizontalAlignment="Left"
                              Margin="16,17,0,0"
                              IsEnabled="False"
                              Checked="SellerIDSelector_Checked"
                              Unchecked="SellerIDSelector_Unchecked"
                              >

                        <TextBlock Width="80"
                                   Height="20"
                                   Text="ID Vendedor"
                                   Grid.Row="1"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Top"
                                   />
                    </CheckBox>

                    <CheckBox x:Name="SaleIDSelector"
                              Grid.Row="1"
                              Width="70"
                              Height="18"
                              VerticalAlignment="Top"
                              HorizontalAlignment="Left"
                              Margin="16,84,0,0"
                              IsEnabled="False"
                              Checked="SaleIDSelector_Checked"
                              Unchecked="SellerIDSelector_Unchecked"
                              >
                        <TextBlock Width="47"
                                   Height="16"
                                   Text="ID Venta"
                                   Grid.Row="1"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Top"
                                   />
                    </CheckBox>

                    <!--Boxes-->
                    <TextBox x:Name="SellerIDField" 
                             Grid.Row="1"
                             Width="120"
                             Height="20"
                             Text="{Binding SellerID}"
                             Margin="10,40,270,105"
                             IsEnabled="False"
                             />
                    <TextBox x:Name="SaleIDField"
                             Grid.Row="1"
                             Width="120"
                             Height="20"
                             Text="{Binding SaleID}" 
                             Margin="10,107,270,38"
                             IsEnabled="False"
                             />
                    <DatePicker x:Name="StartDate"
                                Grid.Row="1" 
                                BorderThickness="0"
                                Margin="151,38,0,0"
                                VerticalAlignment="Top"
                                HorizontalAlignment="Left"
                                SelectedDate="{Binding StartingDate,UpdateSourceTrigger=PropertyChanged}"
                                IsEnabled="False"
                                />
                    <DatePicker x:Name="EndDate"
                                Grid.Row="1"
                                BorderThickness="0"
                                Margin="151,105,0,0"
                                SelectedDate="{Binding EndingDate,UpdateSourceTrigger=PropertyChanged}"
                                VerticalAlignment="Top"
                                HorizontalAlignment="Left"
                                IsEnabled="False"
                                />
                    <!--Search Button-->
                    <Button Style="{StaticResource button}"
                            Grid.Row="1"
                            Height="NaN"
                            Width="NaN"
                            Margin="321,64,21,71"
                            Content="Buscar"
                            Command="{Binding SearchSaleCommand}"
                            >
                    </Button>
                </Grid>
            </Grid>
            <!--Searching results-->
            <DataGrid HorizontalGridLinesBrush="{StaticResource Color5}"
                      VerticalGridLinesBrush="{StaticResource Color5}"
                      Background="{StaticResource Color4}"
                      GridLinesVisibility="All"
                      RowDetailsTemplate="{DynamicResource DataGridRowDetailsTemplate1}"
                      AutoGenerateColumns="False"
                      CellStyle="{DynamicResource DataGridCellStyle1}"
                      ColumnHeaderStyle="{DynamicResource DataGridColumnHeaderStyle1}"
                      x:Name="HistoricSalesDataGrid"
                      ItemsSource="{Binding Path=HistoricSales,UpdateSourceTrigger=PropertyChanged}"
                      SelectedItem="{Binding CurrentSale,UpdateSourceTrigger=PropertyChanged}"
                      Grid.Row="2"
                      Margin="10 0 5 10"
                      >
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Código"
                                        IsReadOnly="True" Width="*"
                                        Binding="{Binding ID}"
                                        />
                    <DataGridTextColumn Header="Fecha"
                                        IsReadOnly="True" 
                                        Width="*" 
                                        Binding="{Binding SaleDate}"
                                        />
                    <DataGridTextColumn Header="Total" 
                                        IsReadOnly="True" 
                                        Width="*" 
                                        Binding="{Binding Total}" 
                                        />
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
        
        <!--Sale details section-->
        <Grid Grid.Column="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="50"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0"
                           Style="{StaticResource titleStyle2}" 
                           Text="Resumen de la venta"
                           />
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="80"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <!--Textblocks to declare the data-->
                    <TextBlock Grid.Column="0"
                               Grid.Row="0"
                               Text="Vendedor: "
                               Margin="13,17,19,15"
                               TextAlignment="Center"
                               />
                    <TextBlock Grid.Column="0"
                               Grid.Row="1"
                               Text="Fecha: "
                               TextAlignment="Center"
                               Margin="0,17,3,15"
                               />
                    <TextBlock Grid.Column="0"
                               Grid.Row="2"
                               Text="Total: "
                               TextAlignment="Center"
                               Margin="20,17,20,15"
                               />
                    <!--Textblocks to show the data-->
                    <TextBlock Grid.Column="1"
                               Grid.Row="0"
                               Text="{Binding SellerName}"
                               Margin="13,17,19,15"
                               TextAlignment="Center"
                               Width="200"
                               />
                    <TextBlock Grid.Column="1"
                               Grid.Row="1"
                               Text="{Binding CurrentSale.SaleDate}"
                               TextAlignment="Center"
                               Margin="0,17,3,15"
                               Width="200"
                               />
                    <TextBlock Grid.Column="1"
                               Grid.Row="2"
                               Text="{Binding CurrentSale.total}"
                               TextAlignment="Center"
                               Width="200"
                               Margin="20,17,20,15"
                               />
                </Grid>
                <DataGrid HorizontalGridLinesBrush="{StaticResource Color5}"
                          VerticalGridLinesBrush="{StaticResource Color5}"
                          Background="{StaticResource Color2}"
                          GridLinesVisibility="All"
                          RowDetailsTemplate="{DynamicResource DataGridRowDetailsTemplate1}"
                          AutoGenerateColumns="False"
                          CellStyle="{DynamicResource DataGridCellStyle1}"
                          ColumnHeaderStyle="{DynamicResource DataGridColumnHeaderStyle1}"
                          x:Name="SaleProducts"
                          Margin= "5 0 10 10"
                          Grid.Row="2"                             
                          ItemsSource="{Binding Path=SaleProducts,UpdateSourceTrigger=PropertyChanged}"
                          >
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Producto"  
                                            IsReadOnly="True" 
                                            Width="*" 
                                            Binding="{Binding Nombre}"
                                            />
                        <DataGridTextColumn Header="Cantidad" 
                                            IsReadOnly="True" 
                                            Width="*" 
                                            Binding="{Binding Cantidad}"
                                            />
                        <DataGridTextColumn Header="Monto" 
                                            IsReadOnly="True" 
                                            Width="*" 
                                            Binding="{Binding Monto}" 
                                            />
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
